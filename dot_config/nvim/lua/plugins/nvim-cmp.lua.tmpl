return {
  {
    "hrsh7th/nvim-cmp",
    enabled = true,
    {{- if eq .profile "axon-work-computer" }}
    {{- else }}
    dependencies = { "milanglacier/minuet-ai.nvim" },
    opts = function(_, opts)
      -- Add minuet as first source
      table.insert(opts.sources, 1, {
        name = "minuet",
        group_index = 1,
        priority = 100,
        max_item_count = 3,
      })

      -- Increase fetching timeout for LLM responses
      opts.performance = opts.performance or {}
      opts.performance.fetching_timeout = 5000
      opts.performance.async_budget = 1

      -- Add manual trigger mapping
      local cmp = require("cmp")
      opts.mapping = vim.tbl_extend("force", opts.mapping or {}, {
        ["<A-y>"] = require("minuet").make_cmp_map(),
      })

      return opts
    end,
    {{- end }}
  },
}

